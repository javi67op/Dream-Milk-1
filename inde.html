<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>DREAM MILK â€“ à¤¸à¤ªà¤¨à¥‹à¤‚ à¤•à¤¾ à¤¦à¥‚à¤§</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:Segoe UI,Arial;
  background:#f2f5f9;
}
header{
  background:#1e88e5;
  color:white;
  padding:15px;
  text-align:center;
}
.card{
  background:white;
  margin:15px;
  padding:15px;
  border-radius:10px;
  box-shadow:0 4px 12px rgba(0,0,0,.08);
}
h3{margin-top:0}
input,select,button{
  width:100%;
  padding:10px;
  margin:5px 0;
  border-radius:6px;
  border:1px solid #ccc;
}
button{
  background:#1e88e5;
  color:white;
  border:none;
  font-weight:bold;
}
button.danger{background:#e53935}
table{
  width:100%;
  border-collapse:collapse;
}
th,td{
  padding:8px;
  border-bottom:1px solid #ddd;
  text-align:center;
}
@media print{
  body * {visibility:hidden}
  #printArea, #printArea * {visibility:visible}
  #printArea {position:absolute; left:0; top:0; width:100%}
}
</style>
</head>

<body>

<header>
<h2>ðŸ¥› DREAM MILK</h2>
<small>Simple â€¢ Offline â€¢ Professional</small>
</header>

<div class="card">
<h3>Add Farmer</h3>
<input id="fname" placeholder="Farmer Name">
<input id="fcode" placeholder="Farmer Code">
<button onclick="addFarmer()">Save Farmer</button>
</div>

<div class="card">
<h3>Milk Entry</h3>
<input id="ecode" placeholder="Farmer Code">
<select id="milkType">
  <option value="Cow">Cow Milk</option>
  <option value="Buffalo">Buffalo Milk</option>
  <option value="Mix">Mix Milk</option>
</select>
<input type="number" id="litre" placeholder="Milk Litre">
<input type="number" step="0.1" id="fat" placeholder="Fat %">
<input type="number" id="rate" placeholder="Rate per Fat">
<button onclick="addEntry()">Save Entry</button>
</div>

<div class="card">
<h3>Farmers & Bill</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Code</th>
<th>Total â‚¹</th>
<th>Print</th>
<th>Delete</th>
</tr>
</thead>
<tbody id="table"></tbody>
</table>
</div>

<div id="printArea" style="display:none"></div>

<script>
let farmers=JSON.parse(localStorage.getItem("farmers"))||[];
let entries=JSON.parse(localStorage.getItem("entries"))||[];

function save(){
  localStorage.setItem("farmers",JSON.stringify(farmers));
  localStorage.setItem("entries",JSON.stringify(entries));
}

function addFarmer(){
  if(!fname.value||!fcode.value) return alert("Fill all fields");
  farmers.push({name:fname.value,code:fcode.value});
  fname.value=fcode.value="";
  save(); render();
}

function addEntry(){
  if(!ecode.value||!litre.value||!fat.value||!rate.value) return alert("Fill all fields");
  let amount=litre.value*fat.value*rate.value;
  entries.push({
    code:ecode.value,
    type:milkType.value,
    litre:litre.value,
    fat:fat.value,
    rate:rate.value,
    amount:amount,
    date:new Date().toLocaleString()
  });
  save(); render();
}

function total(code){
  return entries.filter(e=>e.code===code)
  .reduce((s,e)=>s+e.amount,0);
}

function del(code){
  if(!confirm("Delete farmer & all data?")) return;
  farmers=farmers.filter(f=>f.code!==code);
  entries=entries.filter(e=>e.code!==code);
  save(); render();
}

function printBill(code){
  let farmer=farmers.find(f=>f.code===code);
  let list=entries.filter(e=>e.code===code);
  let html=`<h2>DREAM MILK BILL</h2>
  <p><b>Name:</b> ${farmer.name}<br>
  <b>Code:</b> ${farmer.code}</p>
  <table border="1" width="100%" cellpadding="6">
  <tr><th>Date</th><th>Milk</th><th>Litre</th><th>Fat</th><th>â‚¹</th></tr>`;
  list.forEach(e=>{
    html+=`<tr>
    <td>${e.date}</td>
    <td>${e.type}</td>
    <td>${e.litre}</td>
    <td>${e.fat}%</td>
    <td>${e.amount.toFixed(2)}</td>
    </tr>`;
  });
  html+=`</table><h3>Total: â‚¹${total(code).toFixed(2)}</h3>`;
  printArea.innerHTML=html;
  printArea.style.display="block";
  window.print();
  printArea.style.display="none";
}

function render(){
  table.innerHTML="";
  farmers.forEach(f=>{
    table.innerHTML+=`
    <tr>
    <td>${f.name}</td>
    <td>${f.code}</td>
    <td>â‚¹ ${total(f.code).toFixed(2)}</td>
    <td><button onclick="printBill('${f.code}')">Print</button></td>
    <td><button class="danger" onclick="del('${f.code}')">X</button></td>
    </tr>`;
  });
}
render();
</script>

</body>
  </html>
